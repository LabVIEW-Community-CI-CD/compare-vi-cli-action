{
  "name": "n-cli-companion",
  "displayName": "N-CLI Companion",
  "description": "Manage compare providers, diagnostics, and CLI workflows from VS Code.",
  "version": "0.1.11",
  "publisher": "local",
  "engines": {
    "vscode": "^1.84.0"
  },
  "categories": [
    "Other"
  ],
  "activationEvents": [
    "onCommand:comparevi.runManualCompare",
    "onCommand:comparevi.runProfile",
    "onCommand:comparevi.compareActiveWithPrevious",
    "onCommand:comparevi.openProfiles",
    "onTaskType:comparevi",
    "onView:comparevi.viCompare",
    "workspaceContains:tools/comparevi.profiles.json",
    "onCommand:comparevi.toggleDiffSuccess"
  ],
  "contributes": {
    "viewsContainers": {
      "activitybar": [
        {
          "id": "comparevi",
          "title": "N-CLI",
          "icon": "media/comparevi.svg"
        }
      ]
    },
    "views": {
      "comparevi": [
        {
          "id": "comparevi.profiles",
          "name": "Profiles"
        },
        {
          "id": "comparevi.viCompare",
          "name": "VI Compare",
          "type": "webview"
        }
      ]
    },
    "commands": [
      {
        "command": "comparevi.runManualCompare",
        "title": "CompareVI: Run Manual Compare"
      },
      {
        "command": "comparevi.runProfile",
        "title": "CompareVI: Run Profile"
      },
      {
        "command": "comparevi.openProfiles",
        "title": "CompareVI: Open/Create Profiles"
      },
      {
        "command": "comparevi.compareActiveWithPrevious",
        "title": "CompareVI: Compare Active VI with Previous Commit"
      },
      {
        "command": "comparevi.runProfileItem",
        "title": "CompareVI: Run Profile (item)"
      },
      {
        "command": "comparevi.openReportForProfile",
        "title": "CompareVI: Open Report for Profile"
      },
      {
        "command": "comparevi.openCaptureForProfile",
        "title": "CompareVI: Open Capture JSON for Profile"
      },
      {
        "command": "comparevi.revealOutputForProfile",
        "title": "CompareVI: Reveal Output Folder for Profile"
      },
      {
        "command": "comparevi.refreshProfiles",
        "title": "CompareVI: Refresh Profiles View"
      },
      {
        "command": "comparevi.openViCompare",
        "title": "CompareVI: Open VI Compare Panel"
      },
      {
        "command": "comparevi.toggleDiffSuccess",
        "title": "CompareVI: Toggle Treat Diff As Success"
      }
    ],
    "configuration": {
      "title": "CompareVI",
      "properties": {
        "comparevi.diffAsSuccess": {
          "type": "boolean",
          "default": true,
          "description": "Treat LVCompare exit code 1 (diff found) as success in VS Code UI."
        },
        "comparevi.autoOpenReportOnDiff": {
          "type": "boolean",
          "default": true,
          "description": "Automatically open compare-report.html when a diff is found and the report exists."
        },
        "comparevi.showSummary": {
          "type": "boolean",
          "default": true,
          "description": "Show a post-run summary with quick actions (open report, reveal folder)."
        },
        "comparevi.passFlags": {
          "type": "boolean",
          "default": false,
          "description": "When true, pass profile flags to Invoke-LVCompare.ps1 via -Flags. Leave false to omit flags (richer CLI artifacts)."
        },
        "comparevi.showFlagPicker": {
          "type": "boolean",
          "default": true,
          "description": "Show a multi-select picker to choose LVCompare flags before running. Uses known flags as options."
        },
        "comparevi.knownFlags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [
            "-nobdcosm",
            "-nofppos",
            "-noattr"
          ],
          "description": "Known LVCompare flags offered in the picker. Edit to add/remove flags as needed."
        },
        "comparevi.showSourcePicker": {
          "type": "boolean",
          "default": true,
          "description": "Prompt to select base/head commit sources when profiles define commit refs."
        },
        "comparevi.keepTempVi": {
          "type": "boolean",
          "default": false,
          "description": "Keep extracted temporary VIs after a run (useful for debugging)."
        },
        "comparevi.profilesPath": {
          "type": "string",
          "default": "tools/comparevi.profiles.json",
          "description": "Path to profiles JSON (workspace-relative)."
        },
        "comparevi.labview.year": {
          "type": "string",
          "enum": [
            "2021",
            "2022",
            "2023",
            "2024",
            "2025"
          ],
          "default": "2025",
          "description": "Default LabVIEW year (string)."
        },
        "comparevi.labview.bits": {
          "type": "string",
          "enum": [
            "64",
            "32"
          ],
          "default": "64",
          "description": "Default LabVIEW bitness (string)."
        },
        "comparevi.paths.baseVi": {
          "type": "string",
          "default": "${workspaceFolder}/VI2.vi",
          "description": "Base VI path. Supports ${workspaceFolder}."
        },
        "comparevi.paths.headVi": {
          "type": "string",
          "default": "${workspaceFolder}/tmp-commit-236ffab/VI2.vi",
          "description": "Head VI path. Supports ${workspaceFolder}."
        },
        "comparevi.output.dir": {
          "type": "string",
          "default": "tests/results/manual-vi2-compare",
          "description": "Output directory for artifacts."
        },
        "comparevi.flags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [
            "-nobdcosm",
            "-nofppos",
            "-noattr"
          ],
          "description": "Additional LVCompare flags (not all scripts use them)."
        },
        "comparevi.presets": {
          "type": "object",
          "default": {},
          "description": "Named parameter presets. Each property is a preset name with an array of flags as its value.",
          "additionalProperties": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "comparevi.panel.testTask": {
          "type": "string",
          "default": "Run Pester Tests (Unit)",
          "description": "VS Code task label to run when the VI Compare panel \"Run Tests\" button is pressed. Clear the value to disable task execution."
        },
        "comparevi.panel.testCommand": {
          "type": "string",
          "default": "",
          "description": "Optional VS Code command id to run when no task is configured. Ignored if comparevi.panel.testTask is set."
        },
        "comparevi.commitRefs.base": {
          "type": "string",
          "default": "HEAD~1",
          "description": "Default git ref used as base for commit compare runs."
        },
        "comparevi.commitRefs.head": {
          "type": "string",
          "default": "HEAD",
          "description": "Default git ref used as head for commit compare runs."
        },
        "comparevi.statusBar": {
          "type": "boolean",
          "default": true,
          "description": "Show a status bar item with the last CompareVI result and a toggle for Treat Diff as Success."
        },
        "comparevi.providers.gcli.path": {
          "type": "string",
          "default": "",
          "description": "Absolute path to the g-cli executable. Leave blank to use the default install location."
        },
        "comparevi.telemetryEnabled": {
          "type": "boolean",
          "default": true,
          "description": "Enable local telemetry logging for compare runs (written to tests/results/telemetry)."
        }
      }
    },
    "keybindings": [
      {
        "command": "comparevi.runManualCompare",
        "key": "ctrl+alt+c",
        "when": "editorTextFocus"
      },
      {
        "command": "comparevi.compareActiveWithPrevious",
        "key": "ctrl+alt+shift+c",
        "when": "editorTextFocus"
      }
    ],
    "taskDefinitions": [
      {
        "type": "comparevi",
        "required": [
          "profile"
        ],
        "properties": {
          "profile": {
            "type": "string",
            "description": "Profile name defined in profiles JSON."
          }
        }
      }
    ],
    "menus": {
      "editor/title": [
        {
          "command": "comparevi.compareActiveWithPrevious",
          "when": "resourceExtname == .vi",
          "group": "navigation@99"
        }
      ],
      "view/title": [
        {
          "command": "comparevi.refreshProfiles",
          "when": "view == comparevi.profiles",
          "group": "navigation@1"
        },
        {
          "command": "comparevi.openProfiles",
          "when": "view == comparevi.profiles",
          "group": "navigation@2"
        }
      ],
      "view/item/context": [
        {
          "command": "comparevi.runProfileItem",
          "when": "view == comparevi.profiles && viewItem == comparevi.profile",
          "group": "inline@1"
        },
        {
          "command": "comparevi.openReportForProfile",
          "when": "view == comparevi.profiles && viewItem == comparevi.profile",
          "group": "1_open@1"
        },
        {
          "command": "comparevi.openCaptureForProfile",
          "when": "view == comparevi.profiles && viewItem == comparevi.profile",
          "group": "1_open@2"
        },
        {
          "command": "comparevi.revealOutputForProfile",
          "when": "view == comparevi.profiles && viewItem == comparevi.profile",
          "group": "navigation@3"
        }
      ]
    }
  },
  "main": "./extension.js",
  "license": "SEE LICENSE IN LICENSE",
  "author": {
    "name": "CompareVI Automation"
  },
  "repository": {
    "type": "git",
    "url": "https://github.com/ni/compare-vi-cli-action"
  },
  "scripts": {
    "package": "npx vsce package",
    "publish": "npx vsce publish",
    "test:unit": "vitest run test/unit",
    "test:ext": "node ./test/runTests.js",
    "test": "npm run test:unit && npm run test:ext"
  },
  "devDependencies": {
    "@vscode/test-electron": "^2.4.9",
    "@vscode/vsce": "^3.6.2",
    "chai": "^4.3.10",
    "glob": "^10.3.10",
    "mocha": "^10.2.0",
    "vitest": "^1.1.0"
  },
  "dependencies": {
    "compare-vi-cli-action": "file:../.."
  }
}