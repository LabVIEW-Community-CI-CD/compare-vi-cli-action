Deterministic Runs Hand-off - Updated 2025-10-09 @ 03:07 UTC

Context Snapshot
- Branch: `issue/88-dev-dashboard-phase2`
- Issue/PR: #88 (open), PR #100 (open against develop, blocked on failing checks)
- Latest commits on branch: Improve runbook DX documentation and summary (`7ab05b9`), Emit LV closure telemetry crumbs (`a00275e`), Generate traceability matrix during single run (`5de39ce`)
- Recent workflow highlights (branch / PR):
  * CI Orchestrated (single, run `18363930420`) — success; published traceability matrix + LV closure crumbs.
  * PR reruns `18363904826` (Fixture Drift Windows) and `18363904875` (vi-binary-check / Pester) triggered; Windows drift still failing at “Verify fixture vs LVCompare (notice-only)” because `compare-exec` notice records lack a `path` property, causing the LVCompare launch assertion to detect 0 post-start events. Pester rerun is still in progress.

Top Priorities for Next Agent
1. Investigate and patch `tools/Verify-FixtureCompare.ps1` / fixture drift workflow so the LVCompare launch assertion tolerates runs with missing `path` metadata (the current failure on 18363904826). Rerun Fixture Drift (Windows) once fixed.
2. Monitor the rerun of `vi-binary-check / Pester (self-hosted)` (18363904875); ensure the Windows self-hosted run goes green after the drift fix.
3. Once both checks succeed, verify PR #100 shows all-required statuses green and prepare to merge (summarize traceability matrix + LV closure telemetry work in the PR comment if needed).
4. If any additional regressions surface (e.g., new LV notice schema), capture the failure details and update the PR/issue with remediation steps.
5. Maintain deterministic posture: keep orchestrated single runs green after code fixes, confirm `traceability-matrix-single` and `lv-closure.ndjson` artifacts continue to publish.

Environment Preconditions (set at session start)
- `$env:LV_SUPPRESS_UI = '1'`
- `$env:LV_NO_ACTIVATE = '1'`
- `$env:LV_CURSOR_RESTORE = '1'`
- `$env:LVCI_SINGLE_COMPARE = '1'`
- `$env:LVCI_SINGLE_COMPARE_AUTOSTOP = '1'`
- `$env:LOCAL_DISPATCHER = '1'`
- `$env:SESSION_LOCK_ENABLED = '1'`
- `$env:SESSION_LOCK_STRICT = '1'`
- Optional telemetry (now defaulted in workflows): `$env:EMIT_LV_CLOSURE_CRUMBS = '1'`

Recent Changes / What's Fixed
- `.github/workflows/ci-orchestrated.yml` defaults to `strategy=single`, publishes traceability matrix artifacts, and emits LV closure crumbs across matrix/single/drift paths.
- `tools/Emit-LVClosureCrumb.ps1` added; orchestrated workflow now records pre/post invoker telemetry automatically.
- `scripts/Invoke-IntegrationRunbook.ps1` writes a phase table + JSON link into the GHA step summary; `docs/INTEGRATION_RUNBOOK.md` and README refreshed with automation/telemetry guidance.
- Traceability matrix builder wired into the single run; artifact upload gate now equipped with `traceability-matrix-single`.

Open Issues / Pending Work
- Fixture Drift (Windows) gate fails due to LV notice parsing (`Verify fixture vs LVCompare` cannot find `path`; `post-start=0`). Needs code fix and rerun.
- `vi-binary-check / Pester (self-hosted)` rerun still in progress; confirm READY + summary once it completes.
- After fixes, rerun necessary workflows (Fixture Drift, vi-binary-check) to unblock PR #100 merge.

Useful Commands & Scripts
- Fixture validator: `pwsh -File tools/Validate-Fixtures.ps1 -Json`
- Update manifest with pair: `pwsh -File tools/Update-FixtureManifest.ps1 -Allow -InjectPair -SetExpectedOutcome any -SetEnforce notice`
- Dispatcher quick smoke: `pwsh -File tools/Quick-DispatcherSmoke.ps1 -PreferWorkspace`
- Orchestrated dispatch helper: `pwsh -File tools/Dispatch-WithSample.ps1 ci-orchestrated.yml -Ref issue/88-dev-dashboard-phase2 -IncludeIntegration true -Strategy single`
- Traceability matrix builder: `pwsh -File scripts/Invoke-PesterSingleLoop.ps1 -TraceMatrix -RenderTraceMatrixHtml`
- Workflow monitor: `pwsh -File tools/Track-WorkflowRun.ps1 -RunId <id> -IncludeCheckRuns`

Artifacts & Logs to Review After Runs
- `tests/results/_diagnostics/lv-closure.ndjson` - ensure pre/post stop crumbs exist (especially post-fix).
- `tests/results/_trace/trace-matrix.json` & `.html` - verify schema + coverage after each single run.
- `results/fixture-drift/**/fixture-verify-summary.json` and `compare-exec.json` - confirm LVCompare launch check content post-fix.
- PR rerun logs (`18363904826`, `18363904875`) — verify READY status, artifact summaries, rerun hints.

Reference Docs
- `docs/DEV_DASHBOARD_PLAN.md`
- `docs/requirements/WATCH_AND_QUEUE.md`
- `docs/LABVIEW_GATING.md`
- `docs/plans/TRACEABILITY_MATRIX_PLAN.md`
- ADR 0001 and linked requirements (use `tools/New-Adr.ps1`, `tools/Link-RequirementToAdr.ps1` for updates)

Reminder
- Keep commits scoped and reference `#88`.
- Leave CI green before handoff; rerun failing PR checks after applying fixes.
